= Configuring the {pluginname} plugin in callback mode
:navtitle: Callback mode
:description: Information on configuring the Comments plugin in callback mode
:keywords: comments, commenting, tinycomments, callback
:pluginname: Comments
:plugincode: comments
:commentsMode: callback

*Callback mode* is the default mode for the {pluginname} plugin. In the callback mode, callback functions are required to save user comments on a server. The {pluginname} functions (create, reply, edit, delete comment, delete all conversations, resolve, lookup, and fetch conversations) are configured differently depending upon the server-side storage configuration.

== How the {pluginname} plugin works in callback mode

All options accept functions incorporating `+done+` and `+fail+` callbacks as parameters. The function return type is not important, but all functions must call exactly one of these two callbacks: `+fail+` or `+done+`.

* The `+fail+` callback takes either a string or a JavaScript Error type.
* The `+done+` callback takes an argument specific to each function.

Most functions (create, reply, and edit) require an `+id+` identifying the *current author*.

[NOTE]
**Current author**: The {pluginname} plugin does not know the name of the current user. Determining the current user and storing the comment related to that user is required to be configured by the integrator.

During the initial load, the {pluginname} uses `+tinycomments_fetch+` callback to retrieve the existing conversation including any additional comments with their respective authors . If not configured, the {pluginname} will fallback to `+tinycomments_lookup+`. 

When a user adds a comment, the {pluginname} plugin uses the `+tinycomments_lookup+` callback to retrieve the selected conversation. 

== Interactive example

The following example uses a simulated server (provided by link:https://netflix.github.io/pollyjs/[Polly.js]), which has been hidden from the example JavaScript to keep the example code concise. The interactions between {productname} and Polly.js are visible in the browser console.

liveDemo::comments-callback[]

== Options

=== Required options

When using callback mode, the {pluginname} plugin requires callback functions for the following options:

* xref:tinycomments_create[`+tinycomments_create+`]
* xref:tinycomments_reply[`+tinycomments_reply+`]
* xref:tinycomments_edit_comment[`+tinycomments_edit_comment+`]
* xref:tinycomments_delete_comment[`+tinycomments_delete_comment+`]
* xref:tinycomments_delete[`+tinycomments_delete+`]
* xref:tinycomments_delete_all[`+tinycomments_delete_all+`]
* xref:tinycomments_lookup[`+tinycomments_lookup+`]

include::partial$configuration/tinycomments_create.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_reply.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_edit_comment.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_delete_comment.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_delete.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_delete_all.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_lookup.adoc[leveloffset=+1]

== Optional options

* xref:tinycomments_resolve[`+tinycomments_resolve+`]
* xref:tinycomments_fetch[`+tinycomments_fetch+`]

include::partial$configuration/tinycomments_resolve.adoc[leveloffset=+1]

include::partial$configuration/tinycomments_fetch.adoc[leveloffset=+1]

include::partial$plugins/comments-open-sidebar.adoc[]

include::partial$plugins/comments-highlighting-css.adoc[]

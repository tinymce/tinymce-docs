= Inline CSS plugin
:navtitle: Inline CSS
:description: takes {productname} documents and outputs HTML formatted according to email-friendly HTML best practices (eg inlined CSS).
:description_short: Inlines {productname} CSS for better presentation in email.
:keywords: plugin, inlinecss, email friendly, email, output, inline, css, post-process, html
:pluginname: Inline CSS
:plugincode: inlinecss
:plugincategory: premium

include::partial$misc/admon-premium-plugin.adoc[]

include::partial$misc/admon-requires-6.3v.adoc[]

As is normal and long-time best practice, {productname} documents keep CSS and HTML separate. This practice is not, however, email-friendly.

The {pluginname} plugin takes a {productname} document, and processes it such that the previously separate CSS is applied inline to each HTML element. This single output file is much closer to the common requirements for sending as an HTML-formatted email.

== Interactive example

liveDemo::inline-css[]

== Basic setup

To add the {pluginname} plugin to the editor, add `{plugincode}` to the `plugins` option in the editor configuration.

For example:

[source,js]
----
tinymce.init({
  selector: 'textarea',  // change this value according to your HTML
  plugins: 'inlinecss',
});
----

== Usage notes

The {pluginname} plugin does not support

. https://developer.mozilla.org/en-US/docs/Web/CSS/Pseudo-classes[Pseudo-classes].
+
For example:
+
[source,css]
----
button:hover {
  color: blue;
}
----

. https://developer.mozilla.org/en-US/docs/Web/CSS/Pseudo-elements[Pseudo-elements].
+
For example:
+
[source,css]
----
p::first-line {
  color: blue;
}
----

. https://developer.mozilla.org/en-US/docs/Web/CSS/At-rule[@ rules].
+
For example:
+
[source,html]
----
@media (screen)
----

. The `!important` property.


=== Classic or iframe mode support

xref:use-tinymce-classic.adoc[Classic or iframe mode] is a sandbox. Consequently, specifying CSS is constrained. 

CSS can be specified in classic mode in the following ways:

. The `content_css` option
+
Setting the xref:add-css-options.adoc#content_css[`content_css`] option automatically creates the `<link>` tag and puts it in the {productname} document’s `<head>`.
+
NOTE: This is the only supported way of adding a stylesheet to {productname} in Classic mode. 

. A CSS stylesheet specified in the `<head>` of the iframe.
+
For example:
+
[source,html]
----
<link rel="stylesheet" href="styles.css">
----

. A `<link>` tag pointing to a stylesheet can also be manually inserted in the iframe `<head>`.

. A `<style>` tag in the `<head>` of the iframe.
+
For example:
+
[source,html]
----
<style>p { color: red; }</style>
----

. A `<style>` tag can also be manually inserted in the iframe `<head>`.

. `style` attributes applied to specific elements within a document. That is, inline CSS

NOTE: By default, {productname} does not support `<style>` tags in the document `<body>`.


=== Inline mode support

xref:use-tinymce-inline.adoc[Inline mode] is not sandboxed. Consequently, any specified CSS can effect how editor content presents. 

CSS can be specified in inline mode in the following ways:

. the `content_css` option
+
Setting the xref:add-css-options.adoc#content_css[`content_css`] option automatically creates the `<link>` tag and puts it in the {productname} document’s `<head>`.
+
NOTE: This is not recommended.

. A CSS stylesheet specified in the `<head>` of the document.
+
For example:
+
[source,html]
----
<head>
<link rel="stylesheet" href="styles.css">
</head>
----

. A `<link>` tag pointing to a stylesheet can also be manually inserted in the document `<head>`.

. A CSS stylesheet specified in the `<body>` of the document.
+
For example:
+
[source,html]
----
<body>
<link rel="stylesheet" href="styles.css">
</body>
----
+
IMPORTANT: This is https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link[not recommended]. Some browsers allow it, however, and it is, as a consequence, honored by {productname} when presented.

. A `<style>` tag in the `<head>` of the document.
+
For example:
+
[source,html]
----
<style>p { color: red; }</style>
----

. A `<style>` tag can also be manually inserted in the document `<head>`.

. `style` attributes applied to specific elements within a document. That is, inline CSS

NOTE: By default, {productname} does not support `<style>` tags in the document `<body>`.


=== Shadow DOM support

IMPORTANT: Although the {pluginname} will likely work when an editor running in classic or inline mode is contained within a shadow root, Shadow DOM is **not** currently supported by {productname}.

When a {productname} instance is in a shadow root, the {pluginame} should still support

* CSS specified by the `xref:add-css-options.adoc#content_css[content_css]` option; and

* CSS specified by the `xref:add-css-options.adoc#content_style[content_style]` option.


==== Classic mode

When a {productname} editor in classic mode is contained within a shadow root, CSS applied to the editor’s content will work as expected if the editor can also safely assume it is not operating in a shadow root.


==== Inline mode

When a {productname} editor in inline mode is contained within a shadow root, tags pointing to CSS declarations — either `<link>` tags pointing to stylesheet files or `<style>` tags containing specific CSS examples — are added as children of the shadow root. These tags do not need to be contained with the `<head>` tag.

As well, when {productname} is working in inline mode, {pluginame} checks if the editor is inside a shadow root. If it finds it is, {pluginame} does not look for CSS declarations outside the shadow root.


// * some pseudo-class selectors. See the specification for more details
// (https://notion.so/tinycloud/Technical-specification-7c16d4522d1241ba9e7364880eab3e51#94b1d13ff444492bbfce789f7876f39c)
// 
// 2. Vogue only supports `@import` @-rules at this stage.
// 
// See the Jira ticket: https://ephocks.atlassian.net/browse/TINY-9265
// 
// see the tech spec for @-rule support:
// https://notion.so/tinycloud/Technical-specification-7c16d4522d1241ba9e7364880eab3e51#555fede3a4ff4a26ad5efdf72bc1af6f.

// This plugin allows extracting the content of the editor with CSS inlined.
// Support classic and inline modes. Can be used in shadow dom. 
// Should be able to extract CSS from the stylesheets defined via
// `content_css` and `font_css` options, and CSS styles defined via `style_css` option.


// There is only one API: `getContent()`.
// Regarding to the events, it dispatches `InlineCSS` event.
// I think it is OK to document this event even though its purpose isn’t really for the user’s usage.


== Options

The following configuration options affect the behavior of the {pluginname} plugin.

include::partial$configuration/inline-css.adoc[]

== Events

// Inline CSS-specific events.

The {pluginname} plugin provides the following events.

include::partial$events/{plugincode}-events.adoc[]

== APIs

The {pluginname} plugin provides the following APIs.

include::partial$plugin-apis/{plugincode}-apis.adoc[]
